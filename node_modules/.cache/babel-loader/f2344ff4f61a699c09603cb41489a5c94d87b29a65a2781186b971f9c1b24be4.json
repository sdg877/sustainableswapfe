{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Link}from'react-router-dom';import{currentUser}from'../lib/currentUser';import ItemEdit from'../Components/ItemEdit.jsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProfilePage(){const[userItems,setUserItems]=useState([]);const[isLoading,setIsLoading]=useState(true);const userToken=localStorage.getItem('access_token');const userId=currentUser();const[editingItemId,setEditingItemId]=useState(null);useEffect(()=>{refreshUserItems(userId,userToken);},[userToken,userId]);const refreshUserItems=(userId,userToken)=>{setIsLoading(true);axios.get(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/profile/\").concat(userId,\"/items/\"),{headers:{Authorization:\"Bearer \".concat(userToken)}}).then(response=>{if(Array.isArray(response.data)){Promise.all(response.data.map(item=>axios.get(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/items/\").concat(item.id,\"/swaps/\"),{headers:{Authorization:\"Bearer \".concat(userToken)}}).then(swapsResponse=>{item.swaps=swapsResponse.data;return item;}))).then(itemsWithSwaps=>{setUserItems(itemsWithSwaps);setIsLoading(false);// Set loading to false after successful data retrieval\n}).catch(error=>{console.error('Error fetching swaps for items:',error);setIsLoading(false);});}else{console.error('Invalid response format for user items:',response.data);setIsLoading(false);}}).catch(error=>{console.error('Error fetching user items:',error);setIsLoading(false);});};const handleDelete=itemId=>{axios.delete(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/items/\").concat(itemId,\"/delete/\"),{headers:{Authorization:\"Bearer \".concat(userToken)}}).then(response=>{setUserItems(prevItems=>prevItems.filter(item=>item.id!==itemId));}).catch(error=>{console.error('Error deleting item:',error);});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Your Items\"}),isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):userItems.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"card-container\",children:userItems.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"item-card\",children:[/*#__PURE__*/_jsx(Link,{to:\"/items/\".concat(item.id),children:/*#__PURE__*/_jsx(\"h2\",{children:item.item_title})}),/*#__PURE__*/_jsx(\"p\",{children:item.item_description}),/*#__PURE__*/_jsx(\"h4\",{children:\"Swaps:\"}),/*#__PURE__*/_jsx(\"div\",{children:item.swaps&&item.swaps.length>0?item.swaps.map(swap=>/*#__PURE__*/_jsxs(\"p\",{children:[swap.item_title,\", \",swap.item_description]},swap.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No swaps yet\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>handleDelete(item.id),children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>setEditingItemId(item.id),children:\"Edit\"})]},item.id))}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"No items yet\"}),/*#__PURE__*/_jsx(Link,{to:\"/items/create\",className:\"btn btn-primary\",children:\"Create Item\"})]}),editingItemId&&/*#__PURE__*/_jsx(ItemEdit,{itemId:editingItemId,userToken:userToken})]});}export default ProfilePage;","map":{"version":3,"names":["React","useState","useEffect","axios","Link","currentUser","ItemEdit","jsx","_jsx","jsxs","_jsxs","ProfilePage","userItems","setUserItems","isLoading","setIsLoading","userToken","localStorage","getItem","userId","editingItemId","setEditingItemId","refreshUserItems","get","concat","process","env","REACT_APP_BACKEND_URL","headers","Authorization","then","response","Array","isArray","data","Promise","all","map","item","id","swapsResponse","swaps","itemsWithSwaps","catch","error","console","handleDelete","itemId","delete","prevItems","filter","children","length","className","to","item_title","item_description","swap","onClick"],"sources":["/Users/sylviadrake-gill/code/sustainableswapshop/frontend/my-react-app/src/Pages/ProfilePage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { currentUser } from '../lib/currentUser';\nimport ItemEdit from '../Components/ItemEdit.jsx';\n\nfunction ProfilePage() {\n    const [userItems, setUserItems] = useState([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const userToken = localStorage.getItem('access_token');\n    const userId = currentUser();\n    const [editingItemId, setEditingItemId] = useState(null);\n\n    useEffect(() => {\n        refreshUserItems(userId, userToken);\n    }, [userToken, userId]);\n\n    const refreshUserItems = (userId, userToken) => {\n        setIsLoading(true); \n        axios.get(`${process.env.REACT_APP_BACKEND_URL}/profile/${userId}/items/`, {\n            headers: {\n                Authorization: `Bearer ${userToken}`\n            }\n        })\n        .then(response => {\n            if (Array.isArray(response.data)) {\n                Promise.all(response.data.map(item =>\n                    axios.get(`${process.env.REACT_APP_BACKEND_URL}/items/${item.id}/swaps/`, {\n                        headers: {\n                            Authorization: `Bearer ${userToken}`\n                        }\n                    }).then(swapsResponse => {\n                        item.swaps = swapsResponse.data;\n                        return item;\n                    })\n                )).then(itemsWithSwaps => {\n                    setUserItems(itemsWithSwaps);\n                    setIsLoading(false); // Set loading to false after successful data retrieval\n                }).catch(error => {\n                    console.error('Error fetching swaps for items:', error);\n                    setIsLoading(false); \n                });\n            } else {\n                console.error('Invalid response format for user items:', response.data);\n                setIsLoading(false); \n            }\n        })\n        .catch(error => {\n            console.error('Error fetching user items:', error);\n            setIsLoading(false); \n        });\n    };\n\n    const handleDelete = (itemId) => {\n        axios.delete(`${process.env.REACT_APP_BACKEND_URL}/items/${itemId}/delete/`, {\n            headers: {\n                Authorization: `Bearer ${userToken}`\n            }\n        })\n        .then(response => {\n            setUserItems(prevItems => prevItems.filter(item => item.id !== itemId));\n        })\n        .catch(error => {\n            console.error('Error deleting item:', error);\n        });\n    };\n\n    return (\n        <div>\n            <h1>Your Items</h1>\n            {isLoading ? (\n                <p>Loading...</p>\n            ) : userItems.length > 0 ? (\n                <div className=\"card-container\">\n                    {userItems.map(item => (\n                        <div className=\"item-card\" key={item.id}>\n                            <Link to={`/items/${item.id}`}>\n                                <h2>{item.item_title}</h2>\n                            </Link>\n                            <p>{item.item_description}</p>\n                            <h4>Swaps:</h4>\n                            <div>\n                                {item.swaps && item.swaps.length > 0 ? (\n                                    item.swaps.map(swap => (\n                                        <p key={swap.id}>{swap.item_title}, {swap.item_description}</p>\n                                    ))\n                                ) : (\n                                    <p>No swaps yet</p>\n                                )}\n                            </div>\n                            <button className=\"btn btn-primary\" onClick={() => handleDelete(item.id)}>Delete</button>\n                            <button className=\"btn btn-primary\" onClick={() => setEditingItemId(item.id)}>Edit</button>\n                        </div>\n                    ))}\n                </div>\n            ) : (\n                <div>\n                    <p>No items yet</p>\n                    <Link to=\"/items/create\" className=\"btn btn-primary\">Create Item</Link>\n                </div>\n            )}\n            {editingItemId && (\n                <ItemEdit\n                    itemId={editingItemId}\n                    userToken={userToken}\n                />\n            )}\n        </div>\n    );\n}\n\nexport default ProfilePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}