{"ast":null,"code":"import axios from 'axios';\nlet refresh = false;\naxios.interceptors.response.use(resp => resp, async error => {\n  console.log(error.response.status);\n  if (error.response.status === 401 && !refresh) {\n    refresh = true;\n    const response = await axios.post(`${process.env.REACT_BACKEND_URL}/token/refresh`, {\n      refrsh: localStorage.getItem('refresh_token')\n    }, {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }, {\n      withCredentials: true\n    });\n    if (response.status === 200) {\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer${response[\"access\"]}`;\n      localStorage.setItem('access_token', response.data.access);\n      localStorage.setItem('refresh_token', response.data.refresh);\n      return axios(error.config);\n    }\n  }\n  refresh = false;\n  return error;\n});","map":{"version":3,"names":["axios","refresh","interceptors","response","use","resp","error","console","log","status","post","process","env","REACT_BACKEND_URL","refrsh","localStorage","getItem","headers","withCredentials","defaults","common","setItem","data","access","config"],"sources":["/Users/sylviadrake-gill/code/sustainableswapshop/frontend/my-react-app/src/interceptors/axios.js"],"sourcesContent":["import axios from 'axios'\n\nlet refresh = false \n\naxios.interceptors.response.use(\n    resp => resp,\n    async error => {\n        console.log(error.response.status)\n        if(error.response.status === 401 && !refresh) {\n            refresh = true\n            const response = await axios.post(\n                `${process.env.REACT_BACKEND_URL}/token/refresh`,\n                {\n                    refrsh: localStorage.getItem('refresh_token')\n                },\n                {\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                },\n                {\n                    withCredentials: true\n                }\n            )\n            if ( response.status === 200 ){\n                axios.defaults.headers.common[\"Authorization\"] = `Bearer${response[\"access\"]}`\n                localStorage.setItem('access_token', response.data.access)\n                localStorage.setItem('refresh_token', response.data.refresh)\n                return axios(error.config)\n            }\n\n        }\n        refresh = false\n        return error\n\n    }\n)"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,IAAIC,OAAO,GAAG,KAAK;AAEnBD,KAAK,CAACE,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC3BC,IAAI,IAAIA,IAAI,EACZ,MAAMC,KAAK,IAAI;EACXC,OAAO,CAACC,GAAG,CAACF,KAAK,CAACH,QAAQ,CAACM,MAAM,CAAC;EAClC,IAAGH,KAAK,CAACH,QAAQ,CAACM,MAAM,KAAK,GAAG,IAAI,CAACR,OAAO,EAAE;IAC1CA,OAAO,GAAG,IAAI;IACd,MAAME,QAAQ,GAAG,MAAMH,KAAK,CAACU,IAAI,CAC5B,GAAEC,OAAO,CAACC,GAAG,CAACC,iBAAkB,gBAAe,EAChD;MACIC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,eAAe;IAChD,CAAC,EACD;MACIC,OAAO,EAAE;QACL,cAAc,EAAE;MACpB;IACJ,CAAC,EACD;MACIC,eAAe,EAAE;IACrB,CACJ,CAAC;IACD,IAAKf,QAAQ,CAACM,MAAM,KAAK,GAAG,EAAE;MAC1BT,KAAK,CAACmB,QAAQ,CAACF,OAAO,CAACG,MAAM,CAAC,eAAe,CAAC,GAAI,SAAQjB,QAAQ,CAAC,QAAQ,CAAE,EAAC;MAC9EY,YAAY,CAACM,OAAO,CAAC,cAAc,EAAElB,QAAQ,CAACmB,IAAI,CAACC,MAAM,CAAC;MAC1DR,YAAY,CAACM,OAAO,CAAC,eAAe,EAAElB,QAAQ,CAACmB,IAAI,CAACrB,OAAO,CAAC;MAC5D,OAAOD,KAAK,CAACM,KAAK,CAACkB,MAAM,CAAC;IAC9B;EAEJ;EACAvB,OAAO,GAAG,KAAK;EACf,OAAOK,KAAK;AAEhB,CACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}