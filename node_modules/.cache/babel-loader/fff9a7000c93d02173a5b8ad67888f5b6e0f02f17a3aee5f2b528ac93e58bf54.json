{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useParams}from'react-router-dom';import SwapForm from'./SwapForm';import{currentUser}from'../lib/currentUser';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ItemViewPage(){const{itemId}=useParams();const[item,setItem]=useState(null);const[swaps,setSwaps]=useState([]);const[loading,setLoading]=useState(true);const loggedInUserId=currentUser();// Get current user ID\nconst fetchItemDetails=useCallBack(async()=>{try{const[itemResponse,swapsResponse]=await Promise.all([axios.get(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/items/\").concat(itemId,\"/\")),axios.get(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/items/\").concat(itemId,\"/swaps/\"))]);setItem(itemResponse.data);setSwaps(swapsResponse.data);setLoading(false);}catch(error){console.error('Error fetching item details:',error);setLoading(false);}},[itemId]);useEffect(()=>{fetchItemDetails();},[itemId,fetchItemDetails]);const handleFormSubmit=async formData=>{try{const response=await axios.post(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/create_swap/\").concat(itemId,\"/\"),formData,{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('access_token'))}});const newSwap=response.data;setSwaps(prevSwaps=>[...prevSwaps,formData]);fetchItemDetails();console.log(newSwap);}catch(error){console.error('Error submitting offer:',error);}};if(loading){return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});}if(!item){return/*#__PURE__*/_jsx(\"p\",{children:\"Error: Item not found\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"centered-item-card-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"item-card enlarged\",children:[/*#__PURE__*/_jsx(\"h1\",{children:item.item_title}),/*#__PURE__*/_jsx(\"p\",{children:item.item_description}),/*#__PURE__*/_jsx(\"img\",{src:item.image_url,alt:item.item_title}),/*#__PURE__*/_jsx(\"h4\",{children:\"Swaps:\"}),/*#__PURE__*/_jsx(\"div\",{children:swaps.length>0?swaps.map(swap=>/*#__PURE__*/_jsxs(\"p\",{children:[swap.item_title,\", \",swap.item_description]},swap.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No offers yet\"})}),loggedInUserId&&item&&item.item_user!==loggedInUserId&&/*#__PURE__*/_jsx(SwapForm,{onSubmit:handleFormSubmit,ownerId:item.item_user,itemId:item.item_id})]})});}export default ItemViewPage;","map":{"version":3,"names":["React","useState","useEffect","axios","useParams","SwapForm","currentUser","jsx","_jsx","jsxs","_jsxs","ItemViewPage","itemId","item","setItem","swaps","setSwaps","loading","setLoading","loggedInUserId","fetchItemDetails","useCallBack","itemResponse","swapsResponse","Promise","all","get","concat","process","env","REACT_APP_BACKEND_URL","data","error","console","handleFormSubmit","formData","response","post","headers","Authorization","localStorage","getItem","newSwap","prevSwaps","log","children","className","item_title","item_description","src","image_url","alt","length","map","swap","id","item_user","onSubmit","ownerId","item_id"],"sources":["/Users/sylviadrake-gill/code/sustainableswapshop/frontend/my-react-app/src/Components/ItemViewPage.jsx"],"sourcesContent":["\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport SwapForm from './SwapForm';\nimport { currentUser } from '../lib/currentUser';\n\nfunction ItemViewPage() {\n  const { itemId } = useParams();\n\n  const [item, setItem] = useState(null);\n  const [swaps, setSwaps] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const loggedInUserId = currentUser(); // Get current user ID\n\n  const fetchItemDetails = useCallBack(async () => {\n    try {\n      const [itemResponse, swapsResponse] = await Promise.all([\n        axios.get(`${process.env.REACT_APP_BACKEND_URL}/items/${itemId}/`),\n        axios.get(`${process.env.REACT_APP_BACKEND_URL}/items/${itemId}/swaps/`)\n      ]);\n      setItem(itemResponse.data);\n      setSwaps(swapsResponse.data);\n      setLoading(false);\n    } catch (error) {\n      console.error('Error fetching item details:', error);\n      setLoading(false);\n    }\n  }, [itemId]);\n\n  useEffect(() => {\n    fetchItemDetails();\n  }, [itemId, fetchItemDetails]);\n\n\n  const handleFormSubmit = async (formData) => {\n    try {\n      const response =  await axios.post(`${process.env.REACT_APP_BACKEND_URL}/create_swap/${itemId}/`, formData, {\n        headers: {\n         Authorization: `Bearer ${localStorage.getItem('access_token')}`\n         }\n         })\n      const newSwap = response.data;\n      setSwaps(prevSwaps => [...prevSwaps, formData]);\n      fetchItemDetails();\n      console.log(newSwap)\n    } catch (error) {\n      console.error('Error submitting offer:', error);\n    }\n  };\n\n  if (loading) {\n    return <p>Loading...</p>;\n  }\n\n  if (!item) {\n    return <p>Error: Item not found</p>;\n  }\n\n  return (\n    <div className=\"centered-item-card-container\">\n      <div className=\"item-card enlarged\">\n        <h1>{item.item_title}</h1>\n        <p>{item.item_description}</p>\n        <img\n          src={item.image_url}\n          alt={item.item_title}\n        />\n        <h4>Swaps:</h4>\n        <div>\n          {swaps.length > 0 ? (\n            swaps.map(swap => (\n              <p key={swap.id}>{swap.item_title}, {swap.item_description}</p>\n            ))\n          ) : (\n            <p>No offers yet</p>\n          )}\n        </div>\n        {loggedInUserId && item && item.item_user !== loggedInUserId && (\n          <SwapForm onSubmit={handleFormSubmit} ownerId={item.item_user} itemId={item.item_id} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default ItemViewPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}