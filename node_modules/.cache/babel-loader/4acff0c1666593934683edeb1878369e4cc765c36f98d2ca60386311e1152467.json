{"ast":null,"code":"import axios from'axios';let refresh=false;axios.interceptors.response.use(resp=>resp,async error=>{console.log(error.response.status);if(error.response.status===401&&!refresh){refresh=true;const response=await axios.post(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/token/refresh/\"),{refrsh:localStorage.getItem('refresh_token')},{headers:{\"Content-Type\":\"application/json\"}},{withCredentials:true});if(response.status===200){axios.defaults.headers.common[\"Authorization\"]=\"Bearer\".concat(response[\"access\"]);localStorage.setItem('access_token',response.data.access);localStorage.setItem('refresh_token',response.data.refresh);return axios(error.config);}}refresh=false;return error;});","map":{"version":3,"names":["axios","refresh","interceptors","response","use","resp","error","console","log","status","post","concat","process","env","REACT_APP_BACKEND_URL","refrsh","localStorage","getItem","headers","withCredentials","defaults","common","setItem","data","access","config"],"sources":["/Users/sylviadrake-gill/code/sustainableswapshop/frontend/my-react-app/src/interceptors/axios.js"],"sourcesContent":["import axios from 'axios'\n\nlet refresh = false \n\naxios.interceptors.response.use(\n    resp => resp,\n    async error => {\n        console.log(error.response.status)\n        if(error.response.status === 401 && !refresh) {\n            refresh = true\n            const response = await axios.post(\n                `${process.env.REACT_APP_BACKEND_URL}/token/refresh/`,\n                {\n                    refrsh: localStorage.getItem('refresh_token')\n                },\n                {\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                },\n                {\n                    withCredentials: true\n                }\n            )\n            if ( response.status === 200 ){\n                axios.defaults.headers.common[\"Authorization\"] = `Bearer${response[\"access\"]}`\n                localStorage.setItem('access_token', response.data.access)\n                localStorage.setItem('refresh_token', response.data.refresh)\n                return axios(error.config)\n            }\n\n        }\n        refresh = false\n        return error\n\n    }\n)"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,GAAI,CAAAC,OAAO,CAAG,KAAK,CAEnBD,KAAK,CAACE,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC3BC,IAAI,EAAIA,IAAI,CACZ,KAAM,CAAAC,KAAK,EAAI,CACXC,OAAO,CAACC,GAAG,CAACF,KAAK,CAACH,QAAQ,CAACM,MAAM,CAAC,CAClC,GAAGH,KAAK,CAACH,QAAQ,CAACM,MAAM,GAAK,GAAG,EAAI,CAACR,OAAO,CAAE,CAC1CA,OAAO,CAAG,IAAI,CACd,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAAH,KAAK,CAACU,IAAI,IAAAC,MAAA,CAC1BC,OAAO,CAACC,GAAG,CAACC,qBAAqB,oBACpC,CACIC,MAAM,CAAEC,YAAY,CAACC,OAAO,CAAC,eAAe,CAChD,CAAC,CACD,CACIC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CACJ,CAAC,CACD,CACIC,eAAe,CAAE,IACrB,CACJ,CAAC,CACD,GAAKhB,QAAQ,CAACM,MAAM,GAAK,GAAG,CAAE,CAC1BT,KAAK,CAACoB,QAAQ,CAACF,OAAO,CAACG,MAAM,CAAC,eAAe,CAAC,UAAAV,MAAA,CAAYR,QAAQ,CAAC,QAAQ,CAAC,CAAE,CAC9Ea,YAAY,CAACM,OAAO,CAAC,cAAc,CAAEnB,QAAQ,CAACoB,IAAI,CAACC,MAAM,CAAC,CAC1DR,YAAY,CAACM,OAAO,CAAC,eAAe,CAAEnB,QAAQ,CAACoB,IAAI,CAACtB,OAAO,CAAC,CAC5D,MAAO,CAAAD,KAAK,CAACM,KAAK,CAACmB,MAAM,CAAC,CAC9B,CAEJ,CACAxB,OAAO,CAAG,KAAK,CACf,MAAO,CAAAK,KAAK,CAEhB,CACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}